#@TYPE: Machine
#@NAME: i.MX Drone (WIP)
#@SOC: i.MX6S
#@DESCRIPTION: Temporary drone machine based on NXP i.MX6Solo SABRE SD while porting 3DR Solo board support.

require conf/machine/imx6solosabresd.conf

# Shared override token for Solo/Artoo family customizations.
MACHINEOVERRIDES =. "imx-solo:"

# Drone kernel DTB (derived from legacy imx6solo-3dr-1080p).
KERNEL_DEVICETREE = "nxp/imx/imx6solo-drone.dtb"

# U-Boot config (custom defconfig names for drone/controller).
UBOOT_CONFIG[sd] = "imx6_drone_defconfig,sdcard"

SOLOLINK_CONFIG_DIR = "/etc"

# Match legacy 3DR image tooling expectations (uImage + bundled initramfs).
KERNEL_IMAGETYPE = "uImage"
INITRAMFS_FSTYPES ?= "cpio.gz"
INITRAMFS_IMAGE = "3dr-initramfs"
INITRAMFS_IMAGE_NAME = "${INITRAMFS_IMAGE}-${MACHINE}.rootfs"
INITRAMFS_IMAGE_BUNDLE = "1"

# Meta-3dr uses a custom inittab; avoid extra gettys from default settings.
USE_VT = "0"
SERIAL_CONSOLES = ""

# 3DR legacy stack does not use OP-TEE; keep the simpler sd boot flow for now.
MACHINE_FEATURES:remove = "optee"
